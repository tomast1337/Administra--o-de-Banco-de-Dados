# Banco de Dados

## Centro Federal de EducaÃ§Ã£o TecnolÃ³gica Celso Suckow da Fonseca â€“ CEFET-RJ

## Lista de exercÃ­cios de Ã¡lgebra relacional

### ConsidereÂ o seguinteÂ esquema relacional:

```
    Fornecedores(fid: integer,Â fnome: string,Â end:Â string)
    Pecas(pid: integer, pnome: string, cor:string)
    Catalogo(fid: integer, pid:Â integer,preco: real)
```

## No esquema acima, as chaves estÃ£o sublinhadas. A tabela Catalogo lista o preÃ§o praticado pelos fornecedores para cada peÃ§a fornecida.

CriaÃ§Ã£o das tabelas em SQL:

```sql
create table if not exists `Fornecedores` (
  `fid` int not null,
  `fnome` varchar(25),
  `end` varchar(50),
  primary key(fid)
);

create table if not exists `Pecas`(
  `pid` int not null,
  `pnome` varchar(50),
  `cor` varchar(50),
  primary key(pid)
);

create table if not exists `Catalogo`(
  `fid` int,
  `pid` int,
  `preco` decimal,
  foreign key (`fid`) references `Fornecedores`(`fid`),
  foreign key (`pid`) references `Pecas`(`pid`)
);
```
### ExercÃ­cio #1. Obtenha o nome dos fornecedores que fornecem alguma peÃ§a vermelha.

Resposta:

Algebra Relacional:

```R
RÂ¹ <- Ïƒ cor = 'vermelha' (Pecas)
RÂ² <- RÂ¹ â‹ˆ Catalogo
Ï€ fnome (Fornecedores â‹ˆ RÂ²)

ou

Ï€ fnome (
  Fornecedores â‹ˆ(
    Catalogo â‹ˆ (Ïƒ cor = 'vermelha' (Pecas)
    )
  )
)

```

SQL:
```sql
select `fnome`
from `Fornecedores`
join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
where `Pecas`.`cor` = 'vermelho';
```

### ExercÃ­cio #1. Obtenha o nome dos fornecedores que fornecem alguma peÃ§a vermelha.

Resposta:

Algebra Relacional:

```R
RÂ¹ <- ðœŽ preÃ§o = 100 or preÃ§o = 150 (Catalogo)
RÂ² <- PeÃ§as â‹ˆ RÂ¹ â‹ˆ Fornecedor
ðœ‹ fnome (RÂ²)

ou
ðœ‹ fnome (
  PeÃ§as â‹ˆ Fornecedor â‹ˆ (
    ðœŽ preÃ§o = 100 or preÃ§o = 150 (Catalogo)
  )
)


```

SQL:
```sql
select distinct `fnome`
from `Fornecedores`
    join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
    join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
where `Pecas`.`cor` = 'vermelho';
```

### ExercÃ­cio #3. Obtenha o fid dos fornecedores que fornecem alguma peÃ§a vermelha ou que custe 150.

Resposta:

Algebra Relacional:
```R
RÂ¹ <- ðœŽ preÃ§o = 150 (Catalogo)
RÂ² <- ðœŽ cor=vemelha (PeÃ§as)
ðœ‹ fid (RÂ¹ â‹ˆ RÂ²)

ou
ðœ‹ fid (
  (ðœŽ preÃ§o = 150 (Catalogo))
  â‹ˆ
  (ðœŽ cor=vemelha (PeÃ§as))
)

```

SQL:
```sql
select distinct `Fornecedores`.`fid`
from `Fornecedores`
    join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
    join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
where `Pecas`.`cor` = 'vermelho'
    or `Catalogo`.`preco` = 150;
```

### ExercÃ­cio #4. Obtenha o fid dos fornecedores que fornecem alguma peÃ§a vermelha e alguma peÃ§a verde.

Resposta:

Algebra Relacional:
```R
RÂ¹ <- ðœŽ cor=verde (PeÃ§as)
RÂ² <- ðœŽ cor=vermelha (PeÃ§as)
RÂ³ <- RÂ¹ â‹ˆ Catalogo
Râ´ <- RÂ² â‹ˆ Catalogo
Râµ (ðœ‹ fid,pid (RÂ³)) â‹ƒ (ðœ‹ fid,pid (Râ´))
ðœ‹ fid (Râµ)

ou

ðœ‹ fid (
  (
    ðœ‹ fid,pid (
        (ðœŽ cor=verde (PeÃ§as)) 
        â‹ˆ
        Catalogo)) 
      âˆ©
        (ðœ‹ fid,pid (ðœŽ cor=vermelha (PeÃ§as))
        â‹ˆ
        Catalogo)
  )
)

```

SQL:
```sql
select distinct `Fornecedores`.`fid`
from `Fornecedores`
    join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
    join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
where `Pecas`.`cor` = 'vermelho'
    or `Pecas`.`cor` = 'verde';
```

### ExercÃ­cio #5. Obtenha o nome dos fornecedores que fornecem alguma peÃ§a vermelha que tenha preÃ§o abaixo de 100.

Resposta:

Algebra Relacional:
```R
RÂ¹ <- ðœŽ cor=vermelha (PeÃ§a)
RÂ² <- ðœŽ preÃ§o < 100 (Catalogo)
RÂ³ <- RÂ¹ â‹ˆ RÂ²
Râ´ <- RÂ³ â‹ˆ Fornecedor
ðœ‹ fnome (Râ´)

ou

ðœ‹ fnome (
  (
    (ðœŽ cor=vermelha (PeÃ§a))
    â‹ˆ
    (ðœŽ preÃ§o < 100 (Catalogo))
  ) 
  â‹ˆ
  Fornecedor
)
```

SQL:
```sql
select `fnome`
from `Fornecedores`
    join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
    join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
where `Pecas`.`cor` = 'vermelho'
    and `Catalogo`.`preco` < 100;
```

### ExercÃ­cio #6. Obtenha o nome das peÃ§as que possuem algum fornecedor.

Resposta:

Algebra Relacional:
```R
RÂ¹ <- Catalogo â‹ˆ PeÃ§as
ðœ‹ pnome (RÂ¹)

ou

ðœ‹ pnome (
  Catalogo â‹ˆ PeÃ§as
)

```

SQL:
```sql
select distinct `pnome`
from `Pecas`
    join `Catalogo` on `Catalogo`.`pid` = `Pecas`.`pid`
    join `Fornecedores` on `Catalogo`.`fid` = `Fornecedores`.`fid`;
```

### ExercÃ­cio #7. Obtenha o nome dos fornecedores que fornecem todas as peÃ§as.

Resposta:

Algebra Relacional:
```R
RÂ¹ <- ðœ‹ fid,pid (Catalogo)
RÂ² <- ðœ‹ pid (PeÃ§as)
RÂ³ <- RÂ¹ Ã· RÂ²
ðœ‹ fnome ( RÂ³ )

ou

ðœ‹ fnome (
  (ðœ‹ fid,pid (Catalogo))
  Ã·
  (ðœ‹ pid (PeÃ§as))
)
```

SQL:
```sql
select `fnome`
from `Fornecedores`
    join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
    join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
where `Catalogo`.`pid` not in (
        select `Catalogo`.`pid`
        from `Catalogo`
            join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`
    );
```

### ExercÃ­cio #8. Obtenha o nome das peÃ§as que sÃ£o fornecidas pelo fornecedor "Sempre Alerta" e nÃ£o sÃ£o fornecidas por nenhum outro fornecedor.

Resposta:

Algebra Relacional:
``` R
RÂ¹ = ðœŽ fnome="Sempre Alerta" (Fornecedor)
RÂ² = Fornecedores - RÂ¹
RÂ² = RÂ¹ â‹ˆ Catalogo
Râ´ = RÂ² â‹ˆ Catalogo
Râµ = ðœ‹ pid (RÂ²) - ðœ‹ pid(Râ´)
ðœ‹ fnome (Râµ)

ou

ðœ‹ fnome (
  ðœ‹ pid (
    (
        ðœŽ fnome="Sempre Alerta" (Fornecedor)
    ) â‹ˆ (
      Catalogo
    )
  )
  -
  ðœ‹ pid(
    (
        Fornecedores - (
            ðœŽ fnome="Sempre Alerta" (Fornecedor)
        )
    ) â‹ˆ (
      Catalogo
    )
  )
)
```

SQL:
```sql
select `pnome`
from (
        select `Fornecedores`.`fid`
        from `Fornecedores`
            left join `Catalogo` on `Catalogo`.`fid` = `Fornecedores`.`fid`
        where `Fornecedores`.`fnome` = 'Sempre Alerta'
    ) as `SempreAlerta`
    left join `Catalogo` on `Catalogo`.`fid` = `SempreAlerta`.`fid`
    left join `Pecas` on `Catalogo`.`pid` = `Pecas`.`pid`;
```
